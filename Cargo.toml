[package]
name = "zepter"
version = "0.15.0"
edition = "2021"
authors = [ "Oliver Tale-Yazdi" ]
description = "Analyze, Fix and Format features in your Rust workspace."
license = "GPL-3.0-only"
repository = "https://github.com/ggwpez/zepter"
# Update the README if you change this:
rust-version = "1.70"

[[bin]]
name = "zepter"

[[bench]]
name = "dag"
harness = false
required-features = [ "benchmarking" ]

[dependencies]
anyhow = { version = "1.0.75", optional = true }
assert_cmd = { version = "2.0.12", optional = true }
cargo_metadata = "0.18.1"
clap = { version = "4.4.8", features = ["derive", "cargo"] }
colour = { version = "0.7.0", optional = true }
criterion = { version = "0.5", optional = true }
env_logger = { version = "0.10.1", features = [ "auto-color", "humantime" ], optional = true }
histo = "1.0.0"
itertools = "0.11.0"
log = { version = "0.4.20", optional = true }
semver = "1"
serde = "1.0.192"
serde_json = "1.0.108"
serde_yaml = "0.9.27"
tempfile = { version = "3.8.1", optional = true }
toml_edit = "0.21.0"
tracing = { version = "0.1.40", optional = true }

[dev-dependencies]
anyhow = "1.0.75"
glob = "0.3.1"
lazy_static = "1.4.0"
pretty_assertions = "1.4.0"
rand = "0.8.5"
rstest = "0.18.2"
serde = "1.0.192"
zepter = { path = ".", features = ["testing"] }

[features]
default = [ "logging" ]

logging = [ "dep:env_logger", "dep:log" ]
benchmarking = [ "dep:criterion" ]

testing = [ "dep:anyhow", "dep:assert_cmd", "dep:colour", "dep:tempfile" ]

[profile.dev]
opt-level = 3

[profile.release]
opt-level = 3
debug = true

# Improves speed of the DAG logic by 4-20%. Normally `cargo metadata` is magnitudes slower, so we
# dont sacrifice (human) compile time for this negligible speedup.
[profile.optimized]
inherits = "release"
lto = true
codegen-units = 1
